<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FocusFlow дима привет</title>
    <meta name="description"
        content="FocusFlow" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <!-- ═══════ Particles Background ═══════ -->
    <canvas id="particles-canvas"></canvas>

    <!-- ═══════ LOBBY SCREEN ═══════ -->
    <div id="lobby-screen" class="screen active">
        <!-- Auth Widget (Top Right) -->
        <div class="auth-widget glass-card" id="auth-widget">
            <div id="auth-logged-out">
                <button id="show-login-btn" class="btn btn-secondary btn-sm">Войти</button>
                <button id="show-register-btn" class="btn btn-primary btn-sm">Регистрация</button>
            </div>
            <div id="auth-logged-in" class="hidden">
                <div class="auth-user-info">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--accent-purple)"
                        stroke-width="2">
                        <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2" />
                        <circle cx="12" cy="7" r="4" />
                    </svg>
                    <span id="auth-username" class="auth-username">User</span>
                </div>
                <div class="auth-stats">
                    <span title="Фокус (минут)"><svg width="12" height="12" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10" />
                            <polyline points="12 6 12 12 16 14" />
                        </svg> <span id="auth-focus-time">0</span></span>
                    <span title="Сессий завершено"><svg width="12" height="12" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2">
                            <path d="M22 11.08V12a10 10 0 11-5.93-9.14" />
                            <polyline points="22 4 12 14.01 9 11.01" />
                        </svg> <span id="auth-pomodoros">0</span></span>
                </div>
                <button id="logout-btn" class="btn-icon btn-tiny" title="Выйти"><svg width="14" height="14"
                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4" />
                        <polyline points="16 17 21 12 16 7" />
                        <line x1="21" y1="12" x2="9" y2="12" />
                    </svg></button>
            </div>
        </div>

        <div class="lobby-container">
            <div class="logo-section">
                <div class="logo-icon">
                    <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                        <circle cx="24" cy="24" r="20" stroke="url(#logoGrad)" stroke-width="3"
                            stroke-dasharray="6 4" />
                        <circle cx="24" cy="24" r="12" fill="url(#logoGrad)" opacity="0.15" />
                        <path d="M24 14V24L30 30" stroke="url(#logoGrad)" stroke-width="3" stroke-linecap="round" />
                        <defs>
                            <linearGradient id="logoGrad" x1="4" y1="4" x2="44" y2="44">
                                <stop stop-color="#a78bfa" />
                                <stop offset="1" stop-color="#6d28d9" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
                <h1 class="logo-text">FocusFlow</h1>
                <p class="logo-tagline">Командный таймер для Deep Work</p>
            </div>

            <div class="lobby-card glass-card">
                <div class="input-group">
                    <label for="user-name-input">Ваше имя</label>
                    <input type="text" id="user-name-input" placeholder="Как вас зовут?" maxlength="20"
                        autocomplete="off" />
                </div>

                <div class="lobby-actions">
                    <button id="create-room-btn" class="btn btn-primary">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round">
                            <line x1="12" y1="5" x2="12" y2="19" />
                            <line x1="5" y1="12" x2="19" y2="12" />
                        </svg>
                        Создать комнату
                    </button>

                    <div class="divider"><span>или</span></div>

                    <div class="join-section">
                        <div class="input-group">
                            <label for="room-code-input">Код комнаты</label>
                            <input type="text" id="room-code-input" placeholder="Введите код" maxlength="8"
                                autocomplete="off" style="text-transform: uppercase;" />
                        </div>
                        <button id="join-room-btn" class="btn btn-secondary">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round">
                                <path d="M15 3h4a2 2 0 012 2v14a2 2 0 01-2 2h-4" />
                                <polyline points="10 17 15 12 10 7" />
                                <line x1="15" y1="12" x2="3" y2="12" />
                            </svg>
                            Присоединиться
                        </button>
                    </div>
                </div>

                <p id="lobby-error" class="error-message"></p>
            </div>
        </div>
    </div>

    <!-- ═══════ ROOM SCREEN ═══════ -->
    <div id="room-screen" class="screen">
        <header class="room-header">
            <div class="header-left">
                <button id="leave-room-btn" class="btn-icon" title="Покинуть комнату">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round">
                        <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4" />
                        <polyline points="16 17 21 12 16 7" />
                        <line x1="21" y1="12" x2="9" y2="12" />
                    </svg>
                </button>
                <div class="room-info">
                    <span class="room-label">Комната</span>
                    <span id="room-id-display" class="room-code"></span>
                    <button id="copy-room-id" class="btn-icon btn-tiny" title="Копировать код">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round">
                            <rect x="9" y="9" width="13" height="13" rx="2" />
                            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1" />
                        </svg>
                    </button>
                </div>
            </div>
            <div class="header-right">
                <div class="members-badge" id="members-badge">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round">
                        <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2" />
                        <circle cx="9" cy="7" r="4" />
                        <path d="M23 21v-2a4 4 0 00-3-3.87" />
                        <path d="M16 3.13a4 4 0 010 7.75" />
                    </svg>
                    <span id="member-count">1</span>
                </div>
                <button id="settings-toggle-btn" class="btn-icon" title="Настройки">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round">
                        <circle cx="12" cy="12" r="3" />
                        <path
                            d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z" />
                    </svg>
                </button>
            </div>
        </header>

        <main class="room-main">
            <!-- Timer Area -->
            <div class="timer-area">
                <div id="phase-label" class="phase-label">Фокус</div>
                <div class="session-dots" id="session-dots"></div>

                <div class="timer-ring-container">
                    <svg class="timer-ring" viewBox="0 0 280 280">
                        <defs>
                            <linearGradient id="timerGradWork" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#a78bfa" />
                                <stop offset="100%" stop-color="#6d28d9" />
                            </linearGradient>
                            <linearGradient id="timerGradBreak" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#34d399" />
                                <stop offset="100%" stop-color="#059669" />
                            </linearGradient>
                            <linearGradient id="timerGradLong" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#60a5fa" />
                                <stop offset="100%" stop-color="#2563eb" />
                            </linearGradient>
                        </defs>
                        <circle class="timer-ring-bg" cx="140" cy="140" r="124" />
                        <circle id="timer-ring-progress" class="timer-ring-progress" cx="140" cy="140" r="124" />
                    </svg>
                    <div class="timer-display">
                        <span id="timer-minutes" class="timer-digits">25</span>
                        <span class="timer-colon">:</span>
                        <span id="timer-seconds" class="timer-digits">00</span>
                    </div>
                </div>

                <div class="timer-controls">
                    <button id="reset-btn" class="btn-control" title="Сбросить">
                        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round">
                            <polyline points="1 4 1 10 7 10" />
                            <path d="M3.51 15a9 9 0 102.13-9.36L1 10" />
                        </svg>
                    </button>
                    <button id="start-pause-btn" class="btn-control btn-play" title="Старт">
                        <svg id="play-icon" width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
                            <polygon points="5 3 19 12 5 21 5 3" />
                        </svg>
                        <svg id="pause-icon" width="28" height="28" viewBox="0 0 24 24" fill="currentColor"
                            style="display:none;">
                            <rect x="6" y="4" width="4" height="16" />
                            <rect x="14" y="4" width="4" height="16" />
                        </svg>
                    </button>
                    <button id="skip-btn" class="btn-control" title="Пропустить">
                        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round">
                            <polygon points="5 4 15 12 5 20 5 4" fill="currentColor" />
                            <line x1="19" y1="5" x2="19" y2="19" />
                        </svg>
                    </button>
                    <button id="screen-share-btn" class="btn-control" title="Демонстрация экрана">
                        <svg id="screen-share-icon" width="22" height="22" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round">
                            <rect x="2" y="3" width="20" height="14" rx="2" />
                            <line x1="8" y1="21" x2="16" y2="21" />
                            <line x1="12" y1="17" x2="12" y2="21" />
                        </svg>
                        <svg id="screen-share-stop-icon" class="hidden" width="22" height="22" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
                            <line x1="1" y1="1" x2="23" y2="23" />
                            <rect x="2" y="3" width="20" height="14" rx="2" />
                            <line x1="8" y1="21" x2="16" y2="21" />
                            <line x1="12" y1="17" x2="12" y2="21" />
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Screen Share Viewer -->
            <div id="screen-share-viewer" class="screen-share-viewer hidden">
                <div class="screen-share-header">
                    <div class="screen-share-info">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round">
                            <rect x="2" y="3" width="20" height="14" rx="2" />
                            <line x1="8" y1="21" x2="16" y2="21" />
                            <line x1="12" y1="17" x2="12" y2="21" />
                        </svg>
                        <span id="screen-share-name">Экран</span>
                    </div>
                    <button id="screen-share-close" class="btn-icon" title="Скрыть">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round">
                            <polyline points="4 14 10 14 10 20" />
                            <polyline points="20 10 14 10 14 4" />
                            <line x1="14" y1="10" x2="21" y2="3" />
                            <line x1="3" y1="21" x2="10" y2="14" />
                        </svg>
                    </button>
                </div>
                <video id="screen-share-video" autoplay playsinline></video>
            </div>

            <!-- Members Panel -->
            <aside class="side-panel">
                <div class="panel-section members-section glass-card">
                    <h3 class="panel-title">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round">
                            <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2" />
                            <circle cx="9" cy="7" r="4" />
                        </svg>
                        Участники
                    </h3>
                    <ul id="members-list" class="members-list"></ul>
                </div>

                <!-- Voice Channel -->
                <div class="panel-section voice-section glass-card">
                    <h3 class="panel-title">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round">
                            <path d="M12 1a3 3 0 00-3 3v8a3 3 0 006 0V4a3 3 0 00-3-3z" />
                            <path d="M19 10v2a7 7 0 01-14 0v-2" />
                            <line x1="12" y1="19" x2="12" y2="23" />
                            <line x1="8" y1="23" x2="16" y2="23" />
                        </svg>
                        Голосовой канал
                    </h3>
                    <ul id="voice-members-list" class="voice-members-list"></ul>
                    <div class="voice-controls">
                        <button id="voice-join-btn" class="btn btn-voice-join" title="Войти в голосовой канал">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round">
                                <path d="M15.05 5A5 5 0 0119 8.95M15.05 1A9 9 0 0123 8.94" />
                                <path d="M12 1a3 3 0 00-3 3v8a3 3 0 006 0V4a3 3 0 00-3-3z" />
                                <path d="M19 10v2a7 7 0 01-14 0v-2" />
                            </svg>
                            Подключиться
                        </button>
                        <button id="voice-leave-btn" class="btn btn-voice-leave hidden" title="Отключиться">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round">
                                <line x1="1" y1="1" x2="23" y2="23" />
                                <path d="M9 9v3a3 3 0 005.12 2.12M15 9.34V4a3 3 0 00-5.94-.6" />
                                <path d="M17 16.95A7 7 0 015 12v-2m14 0v2c0 .76-.12 1.49-.34 2.18" />
                                <line x1="12" y1="19" x2="12" y2="23" />
                                <line x1="8" y1="23" x2="16" y2="23" />
                            </svg>
                            Отключиться
                        </button>
                        <div class="voice-action-btns hidden" id="voice-action-btns">
                            <button id="voice-mute-btn" class="btn-icon voice-ctrl-btn" title="Выкл. микрофон">
                                <svg class="icon-mic-on" width="18" height="18" viewBox="0 0 24 24" fill="none"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round">
                                    <path d="M12 1a3 3 0 00-3 3v8a3 3 0 006 0V4a3 3 0 00-3-3z" />
                                    <path d="M19 10v2a7 7 0 01-14 0v-2" />
                                    <line x1="12" y1="19" x2="12" y2="23" />
                                </svg>
                                <svg class="icon-mic-off hidden" width="18" height="18" viewBox="0 0 24 24" fill="none"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round">
                                    <line x1="1" y1="1" x2="23" y2="23" />
                                    <path d="M9 9v3a3 3 0 005.12 2.12M15 9.34V4a3 3 0 00-5.94-.6" />
                                    <path d="M17 16.95A7 7 0 015 12v-2m14 0v2c0 .76-.12 1.49-.34 2.18" />
                                    <line x1="12" y1="19" x2="12" y2="23" />
                                </svg>
                            </button>
                            <button id="voice-deafen-btn" class="btn-icon voice-ctrl-btn" title="Выкл. звук">
                                <svg class="icon-headphones-on" width="18" height="18" viewBox="0 0 24 24" fill="none"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round">
                                    <path d="M3 18v-6a9 9 0 0118 0v6" />
                                    <path
                                        d="M21 19a2 2 0 01-2 2h-1a2 2 0 01-2-2v-3a2 2 0 012-2h3zM3 19a2 2 0 002 2h1a2 2 0 002-2v-3a2 2 0 00-2-2H3z" />
                                </svg>
                                <svg class="icon-headphones-off hidden" width="18" height="18" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
                                    <line x1="1" y1="1" x2="23" y2="23" />
                                    <path d="M3 18v-6a9 9 0 0114.3-7.28" />
                                    <path d="M21 12.28V18" />
                                    <path d="M21 19a2 2 0 01-2 2h-1a2 2 0 01-2-2v-3a2 2 0 012-2h3z" />
                                    <path d="M3 19a2 2 0 002 2h1a2 2 0 002-2v-3a2 2 0 00-2-2H3z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="panel-section chat-section glass-card">
                    <h3 class="panel-title">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round">
                            <path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z" />
                        </svg>
                        Чат
                    </h3>
                    <div id="chat-messages" class="chat-messages"></div>
                    <div class="chat-input-wrapper">
                        <input type="text" id="chat-input" placeholder="Сообщение..." maxlength="200"
                            autocomplete="off" />
                        <button id="chat-send-btn" class="btn-icon" title="Отправить">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round">
                                <line x1="22" y1="2" x2="11" y2="13" />
                                <polygon points="22 2 15 22 11 13 2 9 22 2" />
                            </svg>
                        </button>
                    </div>
                </div>
            </aside>
        </main>

        <!-- Settings Panel (overlay) -->
        <div id="settings-panel" class="settings-overlay hidden">
            <div class="settings-card glass-card">
                <div class="settings-header">
                    <h3>Настройки таймера</h3>
                    <button id="settings-close-btn" class="btn-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round">
                            <line x1="18" y1="6" x2="6" y2="18" />
                            <line x1="6" y1="6" x2="18" y2="18" />
                        </svg>
                    </button>
                </div>
                <div class="settings-body">
                    <div class="setting-row">
                        <label for="setting-work">Фокус (мин)</label>
                        <input type="number" id="setting-work" min="1" max="120" value="25" />
                    </div>
                    <div class="setting-row">
                        <label for="setting-break">Перерыв (мин)</label>
                        <input type="number" id="setting-break" min="1" max="30" value="5" />
                    </div>
                    <div class="setting-row">
                        <label for="setting-long-break">Длинный перерыв (мин)</label>
                        <input type="number" id="setting-long-break" min="1" max="60" value="15" />
                    </div>
                    <div class="setting-row">
                        <label for="setting-sessions">Сессий до длинного перерыва</label>
                        <input type="number" id="setting-sessions" min="1" max="10" value="4" />
                    </div>
                    <button id="save-settings-btn" class="btn btn-primary" style="width:100%;margin-top:12px;">
                        Сохранить
                    </button>
                </div>
            </div>
        </div>

        <!-- Notification Toast -->
        <div id="toast" class="toast hidden">Настройки сохранены!</div>
    </div>

    <!-- ═══════ AUTH MODAL ═══════ -->
    <div class="settings-overlay hidden" id="auth-modal">
        <div class="settings-card glass-card">
            <div class="settings-header">
                <h3 id="auth-modal-title">Вход</h3>
                <button id="auth-close-btn" class="btn-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round">
                        <line x1="18" y1="6" x2="6" y2="18" />
                        <line x1="6" y1="6" x2="18" y2="18" />
                    </svg>
                </button>
            </div>
            <div class="settings-body">
                <form id="auth-form">
                    <div class="input-group">
                        <label for="auth-username-input">Имя пользователя (от 3 символов)</label>
                        <input type="text" id="auth-username-input" required minlength="3" autocomplete="username">
                    </div>
                    <div class="input-group">
                        <label for="auth-password-input">Пароль (от 3 символов)</label>
                        <input type="password" id="auth-password-input" required minlength="3"
                            autocomplete="current-password">
                    </div>
                    <p id="auth-error" class="error-message"></p>
                    <button type="submit" id="auth-submit-btn" class="btn btn-primary"
                        style="margin-top:8px">Войти</button>
                </form>
                <div class="auth-switch">
                    <span id="auth-switch-text">Нет аккаунта?</span>
                    <button id="auth-switch-btn" class="auth-link">Зарегистрироваться</button>
                </div>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="app.js"></script>
</body>

</html>